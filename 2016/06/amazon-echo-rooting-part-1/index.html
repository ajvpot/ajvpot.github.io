<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=mobile-web-app-capable content="yes"><meta name=viewport content="width=device-width,initial-scale=1"><title>Alex Vanderpot</title><meta name=description content="Discover the latest in online security with Alex Vanderpot's personal blog. Stay up to date on the latest developments, gain a deeper understanding of the principles, and get insights on technology and trends."><link rel=icon href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 110 110%22><text y=%22.9em%22 font-size=%2290%22>⭐</text></svg>"><link rel=authorization_endpoint href=https://indieauth.com/auth><link rel=token_endpoint href=https://tokens.indieauth.com/token><link rel=me href=https://github.com/ajvpot><link rel=me href=https://twitter.com/ajvpot><link rel=me href=https://infosec.exchange/@vanderpot><link rel=stylesheet href=https://vanderpot.com/css/layout.css crossorigin=anonymous media=screen><link rel=stylesheet href=https://vanderpot.com/skins/vanderpot.css crossorigin=anonymous media=screen><meta property="og:url" content="https://vanderpot.com/"><meta property="og:title" content="Alex Vanderpot"><meta property="og:site_name" content="Alex Vanderpot"><meta property="og:type" content="website"><meta property="og:description" content="Discover the latest in online security with Alex Vanderpot's personal blog. Stay up to date on the latest developments, gain a deeper understanding of the principles, and get insights on technology and trends."><meta name=twitter:title content="Alex Vanderpot"><meta name=twitter:description content="Discover the latest in online security with Alex Vanderpot's personal blog. Stay up to date on the latest developments, gain a deeper understanding of the principles, and get insights on technology and trends."><meta name=twitter:creator content="ajvpot"></head><body><header><section><div class="header flex row"><div class="header__item flex row"><div id=logo></div><a id=site__name href=https://vanderpot.com/>Alex Vanderpot</a></div><div class="flex row"><nav aria-label="page menu" class="flex row"><ul role=menubar class="flex row"><li role=none><a class=menu__item href=https://vanderpot.com/><svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 22 22" fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M21 11.5a8.38 8.38.0 01-.9 3.8A8.5 8.5.0 0112.5 20a8.38 8.38.0 01-3.8-.9L3 21l1.9-5.7A8.38 8.38.0 014 11.5a8.5 8.5.0 014.7-7.6 8.38 8.38.0 013.8-.9h.5a8.48 8.48.0 018 8v.5z"/></svg></a></li></ul></nav></div></div></section></header><main aria-role=main><section><ul id=feed__ul><li class="feed__li h-entry"><div class=feed__content><time class="hidden dt-published">2016-06-17 20:50:54 +0000 UTC</time><div class="flex properties__row"><div rel=author class="flex left p-author h-card"><img class=u-photo src=https://avatars.githubusercontent.com/u/553597 alt="Alex Vanderpot" id=author-img><div><p rel=me class=p-name id=author-name>Alex Vanderpot</p><p class=properties>Jun 17, 2016</p></div></div><div class="flex right properties"><a class="icon u-url" href=https://vanderpot.com/2016/06/amazon-echo-rooting-part-1/><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-bookmark"><path d="M19 21l-7-5-7 5V5a2 2 0 012-2h10a2 2 0 012 2z"/></svg></a></div></div><article class="md p-summary e-content"><h2 class=p-name>Amazon Echo Rooting: Part 1</h2><p><strong>Update:</strong> You can view Ike Clinton’s <a href=https://vanderpot.com/Clinton_Cook_Paper.pdf>paper</a> that is mentioned in this article here. It is the basis for most of this research so far. There is also a Slack channel and <a href=https://github.com/echohacking/wiki/wiki>wiki </a>about this subject. The PCBs I ordered came in but I haven’t had time to solder the components on or test it out. A few people in the Slack channel have gotten their own code running on the Echo, so it is possible!</p><h1 id=introduction>Introduction</h1><p>I’ve been tentatively looking around for a root exploit or method for the <a href=https://www.amazon.com/dp/B00X4WHP5E>Amazon Echo</a> (not a referral link) since I got mine exactly a year ago. I love what it does and that it’s skills are being expanded every day by the <a href=https://developer.amazon.com/public/solutions/alexa/alexa-skills-kit>Alexa Skills Kit</a>, but I want to dig deeper into the code running on the device and possibly develop some lower level applications than what is allowed by the Alexa Skills Kit or add more music providers (I’m a Google Play Music user). A side effect of my endeavor into the Amazon Echo is being able to audit it for privacy. A few years ago, nobody would have been on board with putting a device specifically designed to listen to you 24/7 from a company like Amazon into their home. Now, the Echo is making appearances in homes across the country. I don’t personally believe the theories that Amazon is always listening (Wireshark strongly implies that they’re not), but I will be able to audit the software to make sure they aren’t.</p><p>I’ve come up with several possible ways to gain access to the Echo:</p><ul><li>Exploit vulnerable service: Embedded devices are notorious for running out of date software with serious security flaws. However, the Echo has very strict firewall rules that prevent access to most services that are running.</li><li>Command injection: The primary user input of the Amazon Echo is the user’s voice. The Echo just uploads the audio data it records to Amazon and gets a response to relay, so it is extremely unlikely that we will be able to gain access to the Echo this way.</li><li>Hardware: The Amazon echo has several debug pads on the bottom of the device that had an unknown function until recently. This is probably the most viable way to gain access to the device. I plan to use this method first, then look around inside the device for any other vulnerabilities.</li></ul><h1 id=gathering-information>Gathering Information</h1><p>After connecting the Echo to my network and observing it’s traffic, I noticed that it downloaded updates in the clear. The Echo uses a modified version of the <a href=https://en.wikipedia.org/wiki/Deb_(file_format)>Debian Package</a> file format with added support for signing of packages. I assume that the echo will not install packages that are not signed by the correct keys. The Echo downloads a package that contains a “manifest” from amzdigitaldownloads.edgesuite.net. The manifest is a list of all available packages.</p><p>While looking through the filesystem, I noticed a static network configuration for a USB Ethernet adapter. This is probably for internal testing at Amazon. We have seen this testing cradle with Ethernet connector in public during a demo of its integration with Vivint security. There are several other interesting bits of information like several references to the project’s original codename “doppler” and voice model data for using the word “Echo” as a wake word instead of “Alexa” or “Amazon.” There is also a firewall setup script that allows us to see which ports are open during normal operation and setup.</p><p>Thanks to a <a href=https://vanderpot.com/Clinton_Cook_Paper.pdf>research project</a> by Ike Clinton and an anonymous source, we now know the pinout of this test header. The Ethernet port was likely connected using SDIO on the SD card pins. There is also a UART console available on UART TX/UART RX at 115200 baud, but it does not accept any user input during the boot process. Attempts to halt or interrupt the U-Boot process were unsuccessful.</p><p><img class=enclosure src=https://vanderpot.com/wp-content/uploads/2016/06/pinout.png alt="Echo Debug Pinout"></p><p><a href=http://www.echotalk.org/index.php/topic,164.0.html><br>Analysis of the Echo’s bootloader code</a> shows that it will attempt to boot from an SD card if one is connected to the pins on the debug header. The pads on this header are slightly smaller than 1x1mm square with a 2mm pitch. To avoid tearing pads off my Echo if I made a mistake and to make the process of connecting an SD card and UART header to an unmodified Echo easier, I attempted to create a 4×5 block with 2mm pin headers. I spent a few hours fiddling with melting the cheap plastic on the headers I had and decided to try to design my first breakout board to use with pogo pins.</p><p><img class=enclosure src=https://vanderpot.com/wp-content/uploads/2016/06/echo_pcb.png alt="Echo Breakout PCB">
The breakout board takes the 4×5 2mm header on the bottom of the Echo and converts it to a MicroSD socket and .1inch header that exposes UART TX, UART RX, GND, and +15V for power. I ordered 10 of these PCBs. When they come I’ll solder on all the components and write another post on creating a SD card that the Echo will boot off of. Hopefully from there I can edit some scripts on the Echo to enable a telnet server and punch a hole in the firewall to allow access to the running system.</p><a class=hidden href=https://brid.gy/publish/mastodon></a>
<a class=hidden href=https://brid.gy/publish/twitter></a>
<a class=hidden href=https://fed.brid.gy/></a>
<data class=p-bridgy-omit-link value=false></data></article><div class="flex properties__row properties"><div class="flex left properties"><span class=properties><span class="dt-published hidden">2016-06-17 20:50:54 +0000 UTC</span>
<a class="icon u-url" href=https://vanderpot.com/2016/06/amazon-echo-rooting-part-1/>7 years ago</a></span></div><div class="flex right"><a class="p-category properties" id=tag href=https://vanderpot.com/tags/Amazon-Echo/>#Amazon Echo</a></div></div></div><script src=/js/webmention.min.js data-wordcount=100 async></script><div id=webmentions></div></li></ul></section></main></body></html>